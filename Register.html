<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Register</title>
        <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp"></script>
        <style>
            body {
              background-image: url('pic/Register.png');
              background-repeat: no-repeat;
              background-attachment: fixed; 
              background-size: 100% 100%;
            }
            </style>
    </head>
<body>
      
  
      <div class="mt-10 sm:mt-20">
        <div class="md:grid md:grid-cols-3 md:gap-3">
          <div class="md:col-span-1">
          </div>
          <div class="mt-5 md:mt-0 md:col-span-2">
            <form action="#" method="POST">
              <div class="shadow overflow-hidden sm:rounded-md">
                <div class="px-4 py-5 bg-white sm:p-6">
                    <h3 class="text-3xl font-medium leading-6 text-gray-900"><br><br>Register</h3><br>
                    <p class="mt-1 text-sm text-gray-600">Please fill out the information truthfully and completely.</p><br><br>
                  <div class="grid grid-cols-6 gap-6">
                    <div class="col-span-6 sm:col-span-3">
                      <label for="first-name" class="block text-sm font-medium text-gray-700">First name</label>
                      <input type="text" name="first-name" id="first-name" autocomplete="given-name" class="mt-1 focus:ring-cyan-600 focus:border-cyan-600 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                    </div>
      
                    <div class="col-span-6 sm:col-span-3">
                      <label for="last-name" class="block text-sm font-medium text-gray-700">Last name</label>
                      <input type="text" name="last-name" id="last-name" autocomplete="family-name" class="mt-1 focus:ring-cyan-600 focus:border-cyan-600 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                    </div>
      
                    <div class="col-span-6 sm:col-span-2">
                      <label for="email-address" class="block text-sm font-medium text-gray-700">Email address</label>
                      <input type="text" name="email-address" id="email-address" autocomplete="email" class="mt-1 focus:ring-cyan-600 focus:border-cyan-600 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                    </div>

                    <div class="col-span-6 sm:col-span-2">
                        <label for="last-name" class="block text-sm font-medium text-gray-700">Phone</label>
                        <input type="text" name="last-name" id="phone" autocomplete="family-name" class="mt-1 focus:ring-cyan-600 focus:border-cyan-600 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                      </div>

                      <div class="col-span-6 sm:col-span-2">
                        <a class="block text-sm font-medium text-gray-700">Sex</a>
                        <select id="sex" name="yearin" autocomplete="country-name" class="mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-cyan-600 focus:border-cyan-600 sm:text-sm">
                          <option>F</option>
                          <option>M</option>
                        </select><br>
                      </div>
                      <div class="col-span-6 sm:col-span-2">
                        <a class="block text-sm font-medium text-gray-700">Date of birth<br>Day</a>
                        <select id="day" name="yearin" autocomplete="country-name" class="mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-cyan-600 focus:border-cyan-600 sm:text-sm">
                            <option>01</option>
                            <option>03</option>
                            <option>04</option>
                            <option>05</option>
                            <option>06</option>
                            <option>07</option>
                            <option>08</option>
                            <option>09</option>
                            <option>10</option>
                            <option>11</option>
                            <option>12</option>
                            <option>13</option>
                            <option>14</option>
                            <option>15</option>
                            <option>16</option>
                            <option>17</option>
                            <option>18</option>
                            <option>19</option>
                            <option>20</option>
                            <option>21</option>
                            <option>22</option>
                            <option>23</option>
                            <option>24</option>
                            <option>25</option>
                            <option>26</option>
                            <option>27</option>
                            <option>28</option>
                            <option>29</option>
                            <option>30</option>
                            <option>31</option>
                        </select><br>
                      </div>
      
                      <div class="col-span-6 sm:col-span-2">
                        <a class="block text-sm font-medium text-gray-700"><br>Month</a>
                        <select id="month" name="yearin" autocomplete="country-name" class="mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-cyan-600 focus:border-cyan-600 sm:text-sm">
                          <option value="12">January</option>
                          <option value="1">February</option>
                          <option value="2">March</option>
                          <option value="3">April</option>
                          <option value="4">May</option>
                          <option value="5">June</option>
                          <option value="6">July</option>
                          <option value="7">August</option>
                          <option value="8">September</option>
                          <option value="9">October</option>
                          <option value="10">November</option>
                          <option value="11">December</option>
                        </select><br>
                      </div>
      
                      <div class="col-span-6 sm:col-span-2">
                        <a class="block text-sm font-medium text-gray-700"><br>Year</a>
                        <select id="year" name="yearin" autocomplete="country-name" class="mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-cyan-600 focus:border-cyan-600 sm:text-sm">
                          <option>2022</option>
                          <option>2021</option>
                          <option>2020</option>
                          <option>2019</option>
                          <option>2018</option>
                          <option>2017</option>
                          <option>2016</option>
                          <option>2015</option>
                          <option>2014</option>
                          <option>2013</option>
                          <option>2012</option>
                          <option>2011</option>
                          <option>2010</option>
                          <option>2009</option>
                          <option>2008</option>
                          <option>2007</option>
                          <option>2006</option>
                          <option>2005</option>
                          <option>2004</option>
                          <option>2003</option>
                          <option>2002</option>
                          <option>2001</option>
                          <option>2000</option>
                          <option>1999</option>
                          <option>1998</option>
                          <option>1997</option>
                          <option>1996</option>
                          <option>1995</option>
                          <option>1994</option>
                          <option>1993</option>
                          <option>1992</option>
                          <option>1991</option>
                          <option>1990</option>
                          <option>1989</option>
                          <option>1987</option>
                          <option>1986</option>
                          <option>1985</option>
                          <option>1984</option>
                          <option>1983</option>
                          <option>1982</option>
                          <option>1981</option>
                          <option>1980</option>
                          <option>1979</option>
                          <option>1978</option>
                          <option>1977</option>
                          <option>1976</option>
                          <option>1975</option>
                          <option>1974</option>
                          <option>1973</option>
                          <option>1972</option>
                          <option>1971</option>
                          <option>1970</option>
                          <option>1969</option>
                          <option>1968</option>
                          <option>1967</option>
                          <option>1966</option>
                          <option>1965</option>
                          <option>1964</option>
                          <option>1963</option>
                          <option>1962</option>
                          <option>1961</option>
                          <option>1960</option>
                          <option>1959</option>
                          <option>1958</option>
                          <option>1957</option>
                          <option>1956</option>
                          <option>1955</option>
                          <option>1954</option>
                          <option>1953</option>
                          <option>1952</option>
                          <option>1951</option>
                          <option>1950</option>
                        </select><br>
                      </div>

                    <div class="col-span-6 sm:col-span-2">
                        <label for="first-name" class="block text-sm font-medium text-gray-700">Username</label>
                        <input type="text" name="username" id="username" autocomplete="given-name" class="mt-1 focus:ring-cyan-600 focus:border-cyan-600 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                      </div>
        
                      <div class="col-span-6 sm:col-span-2">
                        <label for="last-name" class="block text-sm font-medium text-gray-700">Password</label>
                        <input type="password" name="password" id="password" autocomplete="family-name" class="mt-1 focus:ring-cyan-600 focus:border-cyan-600 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                      </div>

                  </div>
                </div>
                <div class="px-4 py-3 bg-gray-50 text-right sm:px-6">
                  <button onclick="register()" type="button" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-cyan-600 hover:bg-cyan-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-cyan-600">Save</button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
      <script>

        function register(){
          var fn=document.getElementById("first-name").value
          var ln=document.getElementById("last-name").value
          var ea=document.getElementById("email-address").value
          var pc=document.getElementById("phone").value
          var sc=document.getElementById("sex").value
          var dc=document.getElementById("day").value
          var mc=document.getElementById("month").value
          var yc=document.getElementById("year").value
          var un=document.getElementById("username").value
          var pw=document.getElementById("password").value
          const d = new Date(yc-1, mc ,dc);
          const visitDate = new Date (d.getUTCFullYear(), d.getUTCMonth(), d.getUTCDate());
  
          d.setHours(0, 0, 0, 0);
          function padTo2Digits(num) {
              return num.toString().padStart(2, '0');
          }
          function formatDate(d) {
              return [
                d.getFullYear(),
                padTo2Digits(d.getMonth() + 1),
                padTo2Digits(d.getDate()),
              ].join('-');
          }

          const for_query_change={firstname:fn,lastname:ln,email:ea,phone:pc,sex:sc,dateofbirth:formatDate(d),username:un,password:pw}
          fetch('https://a7.cpe231.kmutt.in.th/api/check_register', {
            method: 'POST', // or 'PUT'
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify(for_query_change), // send username of users to find promotion_id
          })
          .then(response => response.json())
          .then(data => {
            if(String(data.num[0])==="0"){
              console.log(for_query_change)
              fetch('https://a7.cpe231.kmutt.in.th/api/register', {
                method: 'POST', // or 'PUT'
                headers: {
                  'Content-Type': 'application/json',
                },
                body: JSON.stringify(for_query_change), // send username of users to find promotion_id
              })
              .then(response => response.json())
              .then(data => {
                
                if(String(data.status) === "ok"){
                console.log(data.status)
                alert("success")
                window.location = 'https://a7.cpe231.kmutt.in.th/Login.html';
                }else{
                window.location = 'https://a7.cpe231.kmutt.in.th/Register.html';
                }
              })
              .catch((err) => {
                console.log(err);
              });

            }else{
              alert("This username is already used")
              window.location = 'https://a7.cpe231.kmutt.in.th/Register.html';
            }
       
          })
          .catch((err) => {
            console.log(err);
          });
          
        }


      </script>
</body>
</html>