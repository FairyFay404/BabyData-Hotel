<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">



<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Client History</title>
        <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp"></script>
       
    </head>
<body>
    <div class="max-w-10xl mx-auto px-10 sm:px-10"></div>
    <div class="items-center border-gray-100 py-6 md:justify-start  text-white bg-cyan-600">
      <div class="flex justify-start lg:w-0 lg:flex-2">
          <span class="sr-only">Workflow</span>
          &emsp;&emsp;&emsp;&emsp;
          <button onclick="window.location = 'https\:/\/a7.cpe231.kmutt.in.th/Owner.html';" class="navbar-brand flex  text-2xl font-extrabold" >BabyData.com&nbsp&nbsp&nbsp</button>
          <a class="navbar-brand flex  text-2xl font-extrabold">&nbsp|&nbsp&nbsp&nbsp&nbspClient&nbspHistory</a>
      </div>
    </div><br>
    <div class="mt-2 md:mt-0 md:col-span-2"></div>
    <div class="shadow overflow-hidden sm:rounded-md"></div>
    <div class=" ml-16 flex justify-left"> 
    
    <label for="last-name" class="block text-medium font-medium text-gray-700">
            
        Username&emsp;</label></div>
    
    
    <div class="ml-16 flex justify-left"> 
        
        <div class="grid grid-cols-6 gap-6">
        <input type="text" name="search" id="search" autocomplete="family-name" class="sm:col-span-2 mt-1 focus:ring-cyan-600 focus:border-cyan-600 block w-full shadow-sm sm:text-medium border-gray-300 rounded-md" placeholder="Search">
        <button onclick="myFunction()" type="submit" class="inline-flex justify-center py-2 px-8 border border-transparent shadow-sm text-medium font-medium rounded-md text-white bg-cyan-600 hover:bg-cyan-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-cyan-600">Search</button>
        </div>
       
    </div>
    <div class="mt-10 sm:mt-0">
        <div class="px-10 md:grid md:grid-cols-1 md:gap-1">
          <div class="md:col-span-1">
          </div>
          <div class="mt-3 md:mt-0 md:col-span-2">
            <form action="#" method="POST">
              <div class="mt-4 shadow overflow-hidden sm:rounded-md">
      
            <div class="border-t border-gray-200">   
      
                  <div class="mt-4 px-4 flex justify-center"> 
                    <div class="layout" style="width: 100%;">
        
    <table class="table table-bordered table-striped">
        <thead>
          <tr class="table-primary ">
            
            <th scope="col">Username</th>
            <th scope="col">Firstname</th>
            <th scope="col">Lastname</th>
            <th scope="col">Sex</th>
            <th scope="col">Phone</th>
            <th scope="col">Age</th>
            <th scope="col">Email</th>
            <th scope="col">Booked Room Count</th>
            <th scope="col">Booked Activity Count</th>
            <th scope="col">Reserve Food Count</th>
            <th scope="col">Max Room Type</th>
            <th scope="col">Count pers RoomType</th>
          </tr>
        </thead>
        <tbody id="myTable">
          
        </tbody>
      </table>
    </div>
    </div>
    </div>
    <script>
      let text = localStorage.getItem('username');
      const logindata = JSON.parse(text);
      if(logindata.role != 'Owner'){
        window.location = 'https://a7.cpe231.kmutt.in.th/Login.html';
      }
        //fetch('https://a7.cpe231.kmutt.in.th/api/get_client_history')
        fetch('https://a7.cpe231.kmutt.in.th/api/get_client_history')
        .then(response => response.json())
        .then(data => {
          console.log(data)
          var table = document.getElementById('myTable')
          console.log(data.result6.length)
          let j = 0
          for (var i = 0; i < data.result6.length; i++){
                var row = "<tr> <td>"+data.result6[i].username+"</td> <td>"+data.result6[i].first_name+"</td> <td>"+data.result6[i].last_name+"</td> <td>"+data.result6[i].sex+"</td> <td>"+data.result6[i].phone+"</td> <td>"+data.result6[i].Age+"</td>  <td>"+data.result6[i].email+"</td> <td>"+data.result6[i].BookCount+"</td> <td>"+data.result6[i].ActivityCount+"</td> <td>"+data.result6[i].FoodReserveCount+"</td> <td>"+data.result6[i].RoomType+"</td> <td>"+data.result6[i].CountType+"</td></tr>" ;
                table.innerHTML += row
                i=i+data.CountType[j].CountMax-1;
                j++;

            }
            

        })
        .catch((error) => {
          console.error('Error:', error);
        });
    
        function myFunction() {
          var input, filter, table, tr, td, i, txtValue;
          input = document.getElementById("search");
          filter = input.value.toUpperCase();
          table = document.getElementById("myTable");
          tr = table.getElementsByTagName("tr");
          for (i = 0; i < tr.length; i++) {
            td = tr[i].getElementsByTagName("td")[0];
            if (td) {
              txtValue = td.textContent || td.innerText;
              if (txtValue.toUpperCase().indexOf(filter) > -1) {
                tr[i].style.display = "";
              } else {
                tr[i].style.display = "none";
              }
            }       
          }
        }
    </script>
</div>
</dl>
</div>
</div>
</div>
</div>
</body>
</html>

